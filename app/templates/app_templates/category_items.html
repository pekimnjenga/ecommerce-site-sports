{% extends "app_templates/base.html" %}
{% block title %}<title>Item Category</title>{% endblock title %}
{% load static %}
{% load cart_dict %}
{% block content %}
<div class="container my-5">
  {% if items %}
    <div class="row">
      {% for item in items %}
        {% if item.id %}
        <div class="col-md-4 col-sm-6 mb-4">
          <div class="card h-100 shadow-sm">
            <!-- Bootstrap Carousel for slideshow -->
            <div id="carousel-{{ item.id }}" class="carousel slide border rounded shadow-sm" data-bs-ride="carousel">
              <div class="carousel-inner" style="max-height: 300px; object-fit: contain;">
                {% for image in item.images.all %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                  <a href="{% url 'item_details' item.id %}" class="image-link">
                    <img src="{{ image.image_url }}" class="d-block w-100 rounded" style="max-height: 300px; object-fit: contain;" alt="{{ item.name }}">
                  </a>
                </div>
                {% endfor %}
                {% if item.images.count == 0 %}
                <div class="carousel-item active">
                  <a href="{% url 'item_details' item.id %}" class="image-link">
                    <img src="{% static 'app_templates/images/default.png' %}" class="d-block w-100 rounded" style="max-height: 300px; object-fit: contain;" alt="{{ item.name }}">
                  </a>
                </div>
                {% endif %}
              </div>
              <!-- Carousel controls -->
              <button class="carousel-control-prev" type="button" data-bs-target="#carousel-{{ item.id }}" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#carousel-{{ item.id }}" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
              </button>
            </div>
            <!-- Card body -->
            <div class="card-body text-center">
              <a href="{% url 'item_details' item.id %}" class="item-name-link">
                <h5 class="card-title">{{ item.name }}</h5>
              </a>
              <p class="text-muted">Price: <strong>Ksh {{ item.price }}</strong></p>
            </div>
          </div>
        </div>
        {% endif %}
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-warning text-center" role="alert">
      No items available in this category.
    </div>
  {% endif %}
</div>
{% endblock content %}
